[Ubuntu note: fixes and changes unrelated to the CVE were removed from the
 patch.]

Origin: backport, http://ncurses.scripts.mit.edu/?p=ncurses.git;a=commit;h=790a85dbd4a81d5f5d8dd02a44d84f01512ef443

From 790a85dbd4a81d5f5d8dd02a44d84f01512ef443 Mon Sep 17 00:00:00 2001
From: "Thomas E. Dickey" <dickey@invisible-island.net>
Date: Mon, 1 Jun 2020 00:02:30 +0000
Subject: [PATCH] ncurses 6.2 - patch 20200531

 add a check for end-of-string in cvtchar to handle a malformed
 string in infotocap (report/testcase by "puppet-meteor").
  
Index: ncurses-6.2/ncurses/tinfo/captoinfo.c
===================================================================
--- ncurses-6.2.orig/ncurses/tinfo/captoinfo.c
+++ ncurses-6.2/ncurses/tinfo/captoinfo.c
@@ -216,12 +216,15 @@ cvtchar(register const char *sp)
 	}
 	break;
     case '^':
+	len = 2;
 	c = UChar(*++sp);
-	if (c == '?')
+        if (c == '?') {
 	    c = 127;
-	else
+        } else if (c == '\0') {
+            len = 1;
+        } else {
 	    c &= 0x1f;
-	len = 2;
+	}
 	break;
     default:
 	c = UChar(*sp);
